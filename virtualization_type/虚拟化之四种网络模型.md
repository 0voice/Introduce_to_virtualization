# KVM虚拟化之四种网络模型

## 1. 四种网络模型简要说明：
### 1.1 隔离模型
该模型的特点是宿主机上的所有虚拟机之间可以组建网络，但是虚拟机无法与宿主机进行通信，也无法与其他网络的主机或其他宿主机上的虚拟机进行通信；相当于将虚拟机只是连接到一个交换机上，而这个交换机是在宿主机上虚拟出来的，即我们通常所说的网桥设备

### 1.2 路由模型
该模型的特点是在隔离模型的基础上，在宿主机开启了ip路由转发功能，此时的宿主机相当于路由器，完成虚拟机与宿主机的数据报文转发。因此，虚拟机可以宿主机的物理网卡进行通信，但是无法与宿主机之外的主机进行通信，因为宿主机没有对源地址转换，报文可以送到外部主机，但是外部主机无法回应。

### 1.3 NAT模型
该模型的特点是当虚拟机需要与外部进行通信时，需要将源IP地址转换为物理网卡的IP地址，这样外部主机接收到报文后可以正确的将响应报文发送给目标IP地址（宿主机的物理网卡IP地址），因此，实现虚拟机与外部的通信；

注意：该模型仅仅是实现了源地址转换，实现虚拟机与外部网络的通信，但那是外部网络无法访问虚拟机，如果要实现，则需要在宿主机做目标地址转换。

### 1.4 桥接模型
该模型的特点是通过创建一个虚拟网卡，为该虚拟机网卡分配可以访问外部网络的IP地址；此时的物理网卡相当于一台交换机设备；虚拟机可以分配与外部网络通信的IP地址实现与外部网络的通信；此时，虚拟机相当于宿主机所在的局域网内单独的一台主机，它宿主机的地位是同等的，没有依存关系。

## 2. 前期准备
### 2.1 环境说明
本次测试在VMware workstation 12版本的虚拟机环境中进行，注意开启cpu虚拟化功能;
网络适配器使用仅主机模型，共享主机网络的internet。
OS：centos-6.5_x86-64
eth0: 10.241.96.176/24
采用kvm部署虚拟机，磁盘映像文件使用 cirros-0.3.5-x86_64-disk.img

### 2.2 安装qemu-kvm及解决依赖关系
```C
## 装载kvm模块：
[root@C65-201 ~]# modprobe kvm
[root@C65-201 ~]# modprobe kvm-intel

## 安装qemu-kvm、bridge-utils
[root@C65-201 ~]# yum install qemu-kvm bridge-utils

## 确保CPU支持HVM
[root@C65-201 ~]#  grep -E --color=auto "(vmx|svm)" /proc/cpuinfo
```

## 3. 隔离模型











